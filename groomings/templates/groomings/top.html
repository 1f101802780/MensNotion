{% extends "groomings/base.html" %} <!-- base.html(親)の継承 -->
{% load tag_event %}
{% block title %}Grooming{% endblock %} <!-- タイトル -->

{% block content %}
<h1>トップだよ</h1>
{% if user.is_authenticated %}
  <p>ログインしてます</p>
  <p>ログインユーザー:{{ request.user.username }}</p>
  <p>すばるだよ</p>
  <ul>
    <li><a href="{% url 'groomings:user' request.user.id %}">マイページ</a></li>
    <li><a href="{% url 'groomings:create_post' %}">投稿</a></li>
    <li><a href="{% url 'groomings:edit_user' %}">プロフィール編集</a></li>
    <li><a href="{% url 'groomings:change_password' %}">パスワード変更</a></li>
    <li><a href="{% url 'groomings:logout' %}">ログアウト</a></li>
  </ul>
{% else %}
  <p>ログインしてません</p>
  <a href="{% url 'groomings:login' %}">ログイン</a>
{% endif %}
<p>すばるだよ</p>
<h2>url一覧</h2>
<ul>
  <li><a href="{% url 'groomings:signup' %}">新規登録</a></li>
  <li><a href="{% url 'groomings:user_favo' 1 %}">ユーザid1のファボページ</a></li>
  <li><a href="{% url 'groomings:ranking' %}">ランキング</a></li>
  <li><a href="{% url 'groomings:post_detail' 1 %}">投稿id1の投稿詳細ページ(ログインユーザー以外エラー)</a></li>
  <li><a href="{% url 'groomings:question_detail' 1 %}">匿名質問id1の匿名質問詳細ページ(質問関係者以外はtopにリダイレクト)</a></li>
</ul>
  <!-- bodyの中身 -->
  <h1>Grooming</h1>
  <p class= "alert alert-success">男性の身だしなみを評価するアプリです。</p>
  {% for post in posts %}
    <div class="post card">
      <div class="card-header">
        <a href="{% url 'groomings:post_detail' post.id %}" class="postcard-a">{{ post.title }}</a>
        <a href="{% url 'groomings:user' post.user.id %}" class="usercard-a">{{ post.user.username }}</a>
      </div>
      <div class="body">
        <p class="small">{{ post.created_at }} | カテゴリー：{{ post.category }}</p>
        {% if post.image %}
          <img src="{{ post.image.url }}" width="200">
        {% endif %}
        <span>{{ post.text }}</span><br>
        {% if user.is_authenticated %}
          {% if request.user in post.favorite.all %}
          <a href="{% url 'groomings:favorite' post.id %}" class="btn btn-primary">いいね解除<span class="badge badge-light">{{ post | count_favo }}</span></a>
          {% else %}
          <a href="{% url 'groomings:favorite' post.id %}" class="btn btn-outline-primary">いいね<span class="badge badge-light">{{ post | count_favo }}</span></a>
          {% endif %}
        {% endif %}
      </div>
    </div>
    <br>
  {% endfor %}
{% endblock %}
