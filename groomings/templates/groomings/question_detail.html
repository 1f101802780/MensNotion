{% extends "groomings/base.html" %}
{% block title %}匿名質問詳細{% endblock %} <!-- タイトル -->


{% block content %}
    <h1>{{ question.title }}の詳細ページ | 付与ポイント: {{ question.give_point }}</h1>
    {% if question.is_active == True %}
        {% if question.giver == request.user and question.to_recipient_point %}
            <div class="alert alert-info">{{ question.recipient.username }}に星{{ question.to_recipient_point }}の評価をしました。相手の評価待ちです。</div>
        {% elif question.recipient == request.user and question.to_giver_point %}
            <div class="alert alert-info">{{ question.giver.username }}に星{{ question.to_giver_point }}の評価をしました。相手の評価待ちです。</div>
        {% else %}
            {% if not question.to_giver_point and not question_to_recipient_point %}
                <div class="alert alert-info">悩みが解決したら相手を評価しましょう</div>
            {% else %}
                <div class="alert alert-warning">相手が評価しました。あなたも評価しましょう。</div>
            {% endif %}
            <form method="POST">
                {% csrf_token %}
                <input type="radio" name="eval" value="1">1
                <input type="radio" name="eval" value="2">2
                <input type="radio" name="eval" value="3" checked>3
                <input type="radio" name="eval" value="4">4
                <input type="radio" name="eval" value="5">5
                <input type="submit" name="button" value="評価する">
            </form>
        {% endif %}
    {% else %}
        <div class="alert alert-info">
            既にcloseの質問です。
            {{ question.giver.username }} get星{{ question.to_giver_point }}
            {{ question.recipient.username }} get星{{ question.to_recipient_point }}
        </div>
    {% endif %}

    <h2>質問した人: {{ question.giver.username }} | 質問された人: {{ question.recipient.username }}</h2>
    {% if question.image1 %}
    <img src="{{ question.image1.url }}" width="200">
    {% endif %}
    {% if question.image2 %}
    <img src="{{ question.image2.url }}" width="200">
    {% endif %}
    {% if question.image3 %}
    <img src="{{ question.image3.url }}" width="200">
    {% endif %}
    <p>{{ question.text }}</p>

    <h3>返信一覧</h3>
    <ul>
        {% for reply in replys %}
        <li>
            {{reply.giver.username }}<br>
            {% if reply.image %}
            <img src="{{ reply.image.url }}" width="150">
            {% endif %}
            {{ reply.text }}
        </li>
        {% endfor %}
    </ul>
    {% if question.is_active == True %}
        <h2>返信する</h2>
        <form method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            {{ form.as_p }}
            <input type="submit" value="投稿">
        </form>
    {% endif %}
{% endblock %}